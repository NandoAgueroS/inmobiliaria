@model inmobiliaria.Models.Inmueble
@{
    ViewData["Title"] = Model == null ? "Registrar Inmueble" : "Editar Inmueble";

}
<form asp-action="Guardar" method="POST">

    <div class="form-group">
    <div class="text-danger" asp-validation-summary="ModelOnly"></div>
    <div>
        <label asp-for="IdPropietario">Propietario</label>
        <select name="IdPropietario" id="IdPropietario" style="width: 300px;">
        @if (Model != null && Model.Propietario != null)
        {
            <option selected value="@Model.Propietario.Id">@Model.Propietario.Nombre @Model.Propietario.Apellido</option>
        }
        </select>
        <input type="hidden" asp-for="IdPropietario">
        <span asp-validation-for="IdPropietario" class="text-danger"></span>
    </div>
    <div>
        <label asp-for="IdTipo">Tipo</label>
        <select class="form-control" asp-for="IdTipo">
            @{ var tipos = ViewBag.Tipos as IList<inmobiliaria.Models.Tipo>;

                if (tipos != null && tipos.Count > 0)
                {

                    foreach (var tipo in tipos)
                    {
                        if (Model != null && Model.IdTipo == tipo.Id)
                        {
                            <option value="@tipo.Id" selected >@tipo.Descripcion</option>
                        }
                        else
                        {
                           <option value="@tipo.Id">@tipo.Descripcion</option>
                        }
                        
                    }
                }
            }
        </select>
        <span asp-validation-for="IdTipo" class="text-danger"></span>
    </div>
    <div>
        <label class="form-check" asp-for="Uso"></label>
        <input class="form-check-input" asp-for="Uso" type="radio" value="residencial"> Residencial
        <input class="form-check-input" asp-for="Uso" type="radio" value="comercial"> Comercial
        <span asp-validation-for="Uso" class="text-danger" ></span>
    </div>
    <div>
        <label asp-for="Ambientes"></label>
        <input class="form-control" asp-for="Ambientes">
        <span asp-validation-for="Ambientes" class="text-danger"></span>
    </div>
    <div>
        <label asp-for="Direccion"></label>
        <input class="form-control" asp-for="Direccion">
        <span asp-validation-for="Direccion" class="text-danger"></span>
    </div>
    <div>
        <label asp-for="Precio"></label>
        <input class="form-control" asp-for="Precio" type="number" step="0.01">
        <span asp-validation-for="Precio" class="text-danger"></span>
    </div>
    <div></div>
        <label asp-for="Coordenadas"></label>
        <input class="form-control" asp-for="Coordenadas">
        <span asp-validation-for="Coordenadas" class="text-danger"></span>
    </div>
    
    <div>
        <input type="hidden" asp-for="Id">
    </div>
    <button type="submit" class="btn btn-primary">Guardar</button>
        </div>
</form>
@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
        <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
    $('#IdPropietario').select2(
        {
            placeholder: "Seleccione un propietario",
            ajax: {
                url: '/Propietarios/Buscar',
                dataType: 'json',
                delay: 250,
                data: function (params) {
                    return {
                        nombre: params.term
                    };
                },
                processResults: function (data) {
                    return {
                            results: data.map(element => {
                            return { id: element.id, text: element.nombre + ' ' + element.apellido}
                        })
                    };
                },
                cache: true
            },
            minimumInputLength: 3,
        }
    )
    </script>
}
