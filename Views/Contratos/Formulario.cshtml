@model inmobiliaria.Models.Contrato
@{
    ViewData["Title"] = Model == null ? "Registrar contrato" : "Editar contrato";
}
<form asp-action="Guardar" method="POST">

    <div class="form-group">
    <div class="text-danger" asp-validation-summary="ModelOnly"></div>
    <div>
        <label asp-for="IdInquilino">Inquilino</label>
        <select name="IdInquilino" id="IdInquilino" style="width: 300px;">
        @if (Model != null && Model.Inquilino != null)
        {
            <option selected value="@Model.Inquilino.Id">@Model.Inquilino.Nombre @Model.Inquilino.Apellido</option>
        }
        </select>
        <input type="hidden" asp-for="IdInquilino">
        <span asp-validation-for="IdInquilino" class="text-danger"></span>
    </div>
    <div>
        <label asp-for="IdInmueble"></label>
        <select name="IdInmueble" id="IdInmueble" style="width: 300px;">
            @if (Model != null && Model.Inmueble != null)
            {
                <option selected value="@Model.Inmueble.Id">@Model.Inmueble.Direccion</option>
            }
        </select>
        <input type="hidden" asp-for="IdInmueble">
        <span asp-validation-for="IdInmueble" class="text-danger"></span>
    </div>
    <div>
        <label asp-for="Monto"></label>
        <input class="form-control" asp-for="Monto" type="number" step="0.01">
        <span asp-validation-for="Monto" class="text-danger" ></span>
    </div>
    <div>
        <label asp-for="FechaDesde"></label>
        <input class="form-control" asp-for="FechaDesde">
        <span asp-validation-for="FechaDesde" class="text-danger"></span>
    </div>
    <div>
        <label asp-for="FechaHasta"></label>
        <input class="form-control" asp-for="FechaHasta">
        <span asp-validation-for="FechaHasta" class="text-danger"></span>
    </div>
    <div>
        <input type="hidden" asp-for="Id">
    </div>
    <button type="submit" class="btn btn-primary">Guardar</button>
        </div>
</form>
@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
        <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
    $('#IdInquilino').select2(
        {
            placeholder: "Seleccione un inquilino",
            ajax: {
                url: '/Inquilinos/Buscar',
                dataType: 'json',
                delay: 250,
                data: function (params) {
                    return {
                        nombre: params.term
                    };
                },
                processResults: function (data) {
                    return {
                            results: data.map(element => {
                            return { id: element.id, text: element.nombre + ' ' + element.apellido}
                        })
                    };
                },
                cache: true
            },
            minimumInputLength: 3,
        }
    )

    $('#IdInmueble').select2(
        {
            placeholder: "Seleccione un inmueble",
            ajax: {
                url: '/Inmuebles/Buscar',
                dataType: 'json',
                delay: 250,
                data: function (params) {
                    return {
                        direccion: params.term
                    };
                },
                processResults: function (data) {
                    return {
                            results: data.map(element => {
                            return { id: element.id, text: element.direccion}
                        })
                    };
                },
                cache: true
            },
            minimumInputLength: 3,
        }
    )
    </script>
}